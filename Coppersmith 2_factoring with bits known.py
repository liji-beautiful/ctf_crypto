from gmpy2 import iroot,gcd,invert


e = 65537
n=18869360549196438305109291496383638318668425633096064894457967005258338033756333291338200081954895965699241561959856255216753698628113426268571911411569746996372573744836690593113743167057241600619535323306348427010152231672383638239809441757820385614451816947172890305277080172956373065185930708914546909410630139587621727237330586063829050741106505577439488118944170692148906301617471895030087082653493289219173134781239005877212247678756049923551697547775750907415708013662233689215116682684039337118823810846851802963400175172315954110365364933296482201224605904663790581915160335726298554994824933286807098132883
output=10581937586968893251063124168057373502055739916009696545261210847762721182404898076372484943288922291274852739802476418220786347156742824232618802432671821974103602870530081866197774682439962887968597626901919293060531042687928813266854449829529766575607514546176839603216513519142264849845426405100369805943372677154370645419382858960573893650907695658083088471515786481598766725158150132978210179263082610668528686016724680854390480618856616438143795220172206329372304009088361987456246426079184571189366320139403620329673054010457227685760081185958753506656799503968840918009408196613531586304268092125002226437566
p_=5910937755740894318707302696279194062041828167330693629197289530201445768958666826400277773026036235052028330992747106694863927313173135168620033462303799181917939434955419999329691419783727291125921084520958096114130475807249082372369485647
p=17132773034453434119549454285710693928279838239294819249890618711609*(2**800)+p_
"""
一般此类题型都是已知高位求解，但本题是已知低位
只需要多成一个系数再归一化即可
由于根较小，故可以运用铜匠定理
具体通过sage的small_roots()实现

n=18869360549196438305109291496383638318668425633096064894457967005258338033756333291338200081954895965699241561959856255216753698628113426268571911411569746996372573744836690593113743167057241600619535323306348427010152231672383638239809441757820385614451816947172890305277080172956373065185930708914546909410630139587621727237330586063829050741106505577439488118944170692148906301617471895030087082653493289219173134781239005877212247678756049923551697547775750907415708013662233689215116682684039337118823810846851802963400175172315954110365364933296482201224605904663790581915160335726298554994824933286807098132883
p_=5910937755740894318707302696279194062041828167330693629197289530201445768958666826400277773026036235052028330992747106694863927313173135168620033462303799181917939434955419999329691419783727291125921084520958096114130475807249082372369485647
PR.<x> = PolynomialRing(Zmod(n))
f = x +9699890339958126371615247337316263530014356758797264009554233406013454093554509542838264891826069005425307235208124409294638595441129846739166185134428536879039484494364626652722497979253019450193055217565234240264630106175498458097642152183301466179880121261153472338837939455195117578133762255968927228291223519837291450052868051001490022763823984499697905878423569935877349372293573628328728253724061092614071229523193853925931822178825442982986724113048035849039044253965673649779742101834476832125158373472785998948196761736744947238438551843060802133153732809196057095883377713236193264221003692893528899499026*p_
roots = f.small_roots(X=2^224, beta=0.4)
print(roots)

这是sage的代码段
由于n/p的结果比较大，vscode很难解出来，故复制粘贴到sage求解
"""
q=165170692677541667400475164206162323126184332839216067093663628710100854410168794564340538901836035079672409140004051444693087309266211367367553618469259786152981520516896277988880216624585183542267521353561582698228622483563521516086563120867144487957210759113307081930838659144420549339331728562432134279293
d=invert(e,(p-1)*(q-1))
print(pow(output,d,n))

    