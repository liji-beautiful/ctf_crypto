from sympy.ntheory.modular import crt
from gmpy2 import invert,iroot
import os
"""
广播加密主要就是运用中国剩余定理，使得flag^3<N，直接开立方根求解
"""
n1 = 13403508194395318105106606187172350135981042461484610687883113968528711108403162429545261065437483688657146760761773229762944828555674468506749591234906081380992535738015837270872524345829298363571657419166996421865973743194705571438125186498850197904253724814370797464965475793239133845129262176530843054671746875298370825055289054472092756399543506452851476224670275736255776923590679223479475948354272890590375006120529107117908364361671863623456848924494096649662788632953949543365577312942444188855095146511357774129421614240481761409760455397125936884595738624067805595402026208981236681458674077616548503285399
n2 = 16346097073214233308610558472021566994754075074496875839022018497057430654142794659197026652929345921129195780239444427800556275449959435894755407713926263465850879019877425732067397182988483333657959447838285285689276791390757832373626422104843823567880258683028691427172569703419106028850358824553589574474210960534221030033896554367384075023092485938244957606868114081984670869555752626696660014561677726589718041247982807339777402982290993108247141808688261094483978747659997186422189926582588402417292867218247410495514810133792695304527245593673555580182461187261700476266744363142420753615028957753676614565969
n3 = 19940101214303537990975119225403814112944110017154186673938990710605493160896689756675638148717500992696247699499406953095444164571484111635684599757507369716848724023398391917987063284152384116124284253542543220486224616584976478442215139106228337177750303272350137376422594323769445885965451022868934965253921984443708097134548798318447616780640519118787671394231746651374169484358311432010746108829335457498107934309688010743646768841679363947612522876742510900854298620786879137994247933338789365515250192121057979141109903201609572126197033855538492923916570502521084432459387649465939786918326929011913887094711
e = 3
output_1=7947817257946776308181157642518729202750386127233505707972355860527238015188539919356091022601966081398682411925330123204882622867869389820845788614885036022078065986426197302092549117608652077398282239743563991453014288407037895466384904279136572469374809203511690718648763888938397049833479946578128607832580170114626635464979897985693286956509757677501950145937631103676017592599586861151198468420656321126310456591281746658789722126107545395459861343000895221260845421702634897894139550362342377878786841346528294085049581416590360468514954275567797475446534745035903366034660132816943604454151652592453310836159
output_2=5618130454123369910383365610505296897479386060557083534703418598660159215654731435056474798631315312299297902628993982499643673282408408892465291288166869773330679378922342529992574131480500888810573408168488058196736043653524302511288345359584707114424133747049584913125283852080343054433361635437641691465955109955083774358029677729600926748274857921158820314578752650664414974837090501381506522186246065311700447530589279034110226840616092275269097814109578741374823575190834614084508715392868928991649447849962524163541665235031023603927028241959281635229711135455749075187394650917740592584241287105689457363659
output_3=13002666845742607770269327467002877301906649157912200769153209725867558069835465887539667136590400895176737728415180304993185644418227833816145241271713492499237006264019028348418325865471259371266430053227629760032006538249122137907504769308407340841316588838463835023079531259152802543718084274492921111231626948659660824126500092648371806576105428907855570629025210316971695858696276535255725015406074185135402525915215897732427866766107025689832306014929628900529486175000811552635190345368754250620564568447637469196882109069419186418440636420401108497547241887517947531285465192806989708227758807285558540029662
M=[n1,n2,n3]
C=[output_1,output_2,output_3]
new_module=crt(M,C)[1]
new_c=crt(M,C)[0]
print(new_c)
print(pow(iroot(new_c,3)[0],1,new_module))